
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://populationgenomics.github.io/cpg-flow/usage/">
      
      
        <link rel="prev" href="../installation/">
      
      
        <link rel="next" href="../considerations-limitations/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Usage - CPG Flow</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CPG Flow" class="md-header__button md-logo" aria-label="CPG Flow" data-md-component="logo">
      
  <img src="../assets/logo-colour.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CPG Flow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2C5.13 2 2 5.13 2 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm13-8h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="amber"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/populationgenomics/cpg-flow" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    populationgenomics/cpg-flow
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  CPG Flow

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation and Build

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../considerations-limitations/" class="md-tabs__link">
        
  
  
    
  
  Considerations and Limitations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../docker/" class="md-tabs__link">
        
  
  
    
  
  Docker

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tests/" class="md-tabs__link">
          
  
  
    
  
  Tests

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/" class="md-tabs__link">
          
  
  
    
  
  Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CPG Flow" class="md-nav__button md-logo" aria-label="CPG Flow" data-md-component="logo">
      
  <img src="../assets/logo-colour.svg" alt="logo">

    </a>
    CPG Flow
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/populationgenomics/cpg-flow" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    populationgenomics/cpg-flow
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CPG Flow
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation and Build
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#some-toml-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Some .toml configuration file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-entrypoint-for-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      An entrypoint for the pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-stage-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      The Stage definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jobspy-or-equivalent-file-for-job-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      jobs.py or equivalent file for Job definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Running the pipeline
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../considerations-limitations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Considerations and Limitations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tests
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tests
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧪 Unit and E2E tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code-analysis-consistency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔍 Code Linting and Formatting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🎬 GitHub Actions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/stage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stage class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/targets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Target class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/pedigree_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PedigreeInfo class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/filetypes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Filetypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/metamist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metamist
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow class
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#some-toml-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Some .toml configuration file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-entrypoint-for-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      An entrypoint for the pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-stage-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      The Stage definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jobspy-or-equivalent-file-for-job-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      jobs.py or equivalent file for Job definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Running the pipeline
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="usage"><a class="toclink" href="#usage">🤖 Usage</a><a class="headerlink" href="#usage" title="Permanent link">&para;</a></h1>
<p>This project provides the framework to construct pipelines but does not offer hosting the logic of any pipelines themselves. This approach offers the benefit of making all components more modular, manageable and decoupled. Pipelines themselves are hosted in a separate repository.</p>
<p>The <a href="https://github.com/populationgenomics/test_workflows_shared">test_workflows_shared</a> repository acts as a template and demonstrates how to structure a pipeline using CPG Flow.</p>
<p>The components required to build pipelines with CPG Flow:</p>
<h2 id="some-toml-configuration-file"><a class="toclink" href="#some-toml-configuration-file">Some <code>.toml</code> configuration file</a><a class="headerlink" href="#some-toml-configuration-file" title="Permanent link">&para;</a></h2>
<p>This file contains the configuration settings to your pipeline. This file allows the pipeline developer to define settings such as:</p>
<ol>
<li>what stages will be run or skipped</li>
<li>what dataset to use</li>
<li>what access level to use</li>
<li>any input cohorts</li>
<li>sequencing type</li>
</ol>
<div class="highlight"><span class="filename">config.toml</span><pre><span></span><code><span id="__span-0-1"><span class="k">[workflow]</span>
</span><span id="__span-0-2"><span class="n">dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;fewgenomes&#39;</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="c1"># Note: for fewgenomes and sandbox mentioning datasets by name is not a security risk</span>
</span><span id="__span-0-5"><span class="c1"># DO NOT DO THIS FOR OTHER DATASETS</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="n">input_cohorts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;COH2142&#39;</span><span class="p">]</span>
</span><span id="__span-0-8"><span class="n">access_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;test&#39;</span>
</span><span id="__span-0-9">
</span><span id="__span-0-10"><span class="c1"># Force stage rerun</span>
</span><span id="__span-0-11"><span class="n">force_stages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-0-12"><span class="w">    </span><span class="s1">&#39;GeneratePrimes&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># the first stage</span>
</span><span id="__span-0-13"><span class="w">    </span><span class="s1">&#39;CumulativeCalc&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># the second stage</span>
</span><span id="__span-0-14"><span class="w">    </span><span class="s1">&#39;FilterEvens&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># the third stage</span>
</span><span id="__span-0-15"><span class="w">    </span><span class="s1">&#39;BuildAPrimePyramid&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># the last stage</span>
</span><span id="__span-0-16"><span class="p">]</span>
</span><span id="__span-0-17">
</span><span id="__span-0-18"><span class="c1"># Show a workflow graph locally or save to web bucket.</span>
</span><span id="__span-0-19"><span class="c1"># Default is false, set to true to show the workflow graph.</span>
</span><span id="__span-0-20"><span class="n">show_workflow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-0-21"><span class="c1"># ...</span>
</span></code></pre></div>
<p>For a full list of supported config options with documentation, see <a href="https://github.com/populationgenomics/cpg-flow/blob/main/src/cpg_flow/defaults.toml">defaults.toml</a></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This <code>.toml</code> file may be named anything, as long as it is correctly passed to the <code>analysis-runner</code> invocation. The <code>analysis-runner</code> supplies its own default settings, and combines it with the settings from this file, before submitting a job.</p>
</div>
<h2 id="an-entrypoint-for-the-pipeline"><a class="toclink" href="#an-entrypoint-for-the-pipeline">An entrypoint for the pipeline</a><a class="headerlink" href="#an-entrypoint-for-the-pipeline" title="Permanent link">&para;</a></h2>
<p>Ideally a file like <code>main.py</code> that would be the entrypoint for the pipeline, storing the workflow definition as a list of stages, and then running said workflow:</p>
<div class="highlight"><span class="filename">main.py</span><pre><span></span><code><span id="__span-1-1"> <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-1-2"> <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-1-3"> <span class="kn">from</span><span class="w"> </span><span class="nn">cpg_flow.workflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_workflow</span>
</span><span id="__span-1-4"> <span class="kn">from</span><span class="w"> </span><span class="nn">cpg_utils.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_config_paths</span>
</span><span id="__span-1-5"> <span class="kn">from</span><span class="w"> </span><span class="nn">stages</span><span class="w"> </span><span class="kn">import</span> <span class="n">BuildAPrimePyramid</span><span class="p">,</span> <span class="n">CumulativeCalc</span><span class="p">,</span> <span class="n">FilterEvens</span><span class="p">,</span> <span class="n">GeneratePrimes</span>
</span><span id="__span-1-6">
</span><span id="__span-1-7"> <span class="n">CONFIG_FILE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;&lt;YOUR_CONFIG&gt;.toml&#39;</span><span class="p">)</span>
</span><span id="__span-1-8">
</span><span id="__span-1-9"> <span class="k">def</span><span class="w"> </span><span class="nf">run_cpg_flow</span><span class="p">(</span><span class="n">dry_run</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="__span-1-10">
</span><span id="__span-1-11">    <span class="c1">#See the &#39;Key Considerations and Limitations&#39; section for notes on the definition of the `workflow` variable.</span>
</span><span id="__span-1-12">
</span><span id="__span-1-13">    <span class="c1"># This represents the flow of the DAG</span>
</span><span id="__span-1-14">     <span class="n">workflow</span> <span class="o">=</span> <span class="p">[</span><span class="n">GeneratePrimes</span><span class="p">,</span> <span class="n">CumulativeCalc</span><span class="p">,</span> <span class="n">FilterEvens</span><span class="p">,</span> <span class="n">BuildAPrimePyramid</span><span class="p">]</span>
</span><span id="__span-1-15">
</span><span id="__span-1-16">     <span class="n">config_paths</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CPG_CONFIG_PATH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="__span-1-17">
</span><span id="__span-1-18">     <span class="c1"># Inserting after the &quot;defaults&quot; config, but before user configs:</span>
</span><span id="__span-1-19">     <span class="n">set_config_paths</span><span class="p">(</span><span class="n">config_paths</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">CONFIG_FILE</span><span class="p">]</span> <span class="o">+</span> <span class="n">config_paths</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="__span-1-20">     <span class="n">run_workflow</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">workflow</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="n">dry_run</span><span class="p">)</span>
</span><span id="__span-1-21">
</span><span id="__span-1-22"> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span id="__span-1-23">   <span class="n">run_cpg_flow</span><span class="p">()</span>
</span></code></pre></div>
<p>The workflow definition here forms a DAG (Directed Acyclic Graph) structure.</p>
<p><img alt="DAG" src="../assets/newplot.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To generate a plot of the DAG, <code>show_workflow = True</code> should be included in the config. The DAG plot generated from the pipeline definition is available in the logs via the job URL. To find the link to the plot, search the <em>Logs</em> section for the string: "<strong>INFO - Link to the graph:</strong>".</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are some key considerations and limitations to take into account when designing the DAG:</p>
<ul>
<li><a href="../considerations-limitations/#no-forward-discovery">No Forward Discovery</a></li>
<li><a href="../considerations-limitations/#workflow-definition">Workflow Definition</a></li>
</ul>
</div>
<h2 id="the-stage-definitions"><a class="toclink" href="#the-stage-definitions">The <code>Stage</code> definitions</a><a class="headerlink" href="#the-stage-definitions" title="Permanent link">&para;</a></h2>
<p>A <code>Stage</code> represents a node in the DAG. The stages can be abstracted from either a <code>DatasetStage</code>, <code>CohortStage</code>, <code>MultiCohortStage</code>, or a <code>SequencingGroupStage</code>.</p>
<p>The stage definition should use the <code>@stage</code> decorator to <strong><em>optionally</em></strong> set:</p>
<ul>
<li>dependent stages (this is used to build the DAG)</li>
<li>analysis keys (this determines what outputs should be written to metamist)</li>
<li>the analysis type (this determines the analysis-type to be written to metamist)</li>
</ul>
<p>All stages require an <code>expected_outputs</code> class method definition, that sets the expected output path location for a given <code>Target</code> such as a <code>SequencingGroup</code>, <code>Dataset</code>, <code>Cohort</code>, or <code>MultiCohort</code>.</p>
<p>Also required, is a <code>queue_jobs</code> class method definition that calls pipeline jobs, and stores the results of these jobs to the paths defined in <code>expected_outputs</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is good practice to separate the <code>Stage</code> definitions into their own files, to keep the code compact, and manageable.</p>
</div>
<div class="highlight"><span class="filename">stages.py</span><pre><span></span><code><span id="__span-2-1"><span class="kn">from</span><span class="w"> </span><span class="nn">cpg_flow.stage</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequencingGroupStage</span><span class="p">,</span> <span class="n">StageInput</span><span class="p">,</span> <span class="n">StageOutput</span><span class="p">,</span> <span class="n">stage</span>
</span><span id="__span-2-2"><span class="kn">from</span><span class="w"> </span><span class="nn">cpg_flow.targets.sequencing_group</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequencingGroup</span>
</span><span id="__span-2-3"><span class="kn">from</span><span class="w"> </span><span class="nn">jobs</span><span class="w"> </span><span class="kn">import</span> <span class="n">cumulative_calc</span>
</span><span id="__span-2-4">
</span><span id="__span-2-5"><span class="n">WORKFLOW_FOLDER</span> <span class="o">=</span> <span class="s1">&#39;prime_pyramid&#39;</span>
</span><span id="__span-2-6">
</span><span id="__span-2-7"><span class="c1"># ...</span>
</span><span id="__span-2-8"><span class="c1"># This stage depends on the `GeneratePrimes` stage, and requires outputs from that stage.</span>
</span><span id="__span-2-9"><span class="nd">@stage</span><span class="p">(</span><span class="n">required_stages</span><span class="o">=</span><span class="p">[</span><span class="n">GeneratePrimes</span><span class="p">],</span> <span class="n">analysis_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cumulative&#39;</span><span class="p">],</span> <span class="n">analysis_type</span><span class="o">=</span><span class="s1">&#39;custom&#39;</span><span class="p">)</span>
</span><span id="__span-2-10"><span class="k">class</span><span class="w"> </span><span class="nc">CumulativeCalc</span><span class="p">(</span><span class="n">SequencingGroupStage</span><span class="p">):</span>
</span><span id="__span-2-11"> <span class="k">def</span><span class="w"> </span><span class="nf">expected_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequencing_group</span><span class="p">:</span> <span class="n">SequencingGroup</span><span class="p">):</span>
</span><span id="__span-2-12">     <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-2-13">         <span class="s1">&#39;cumulative&#39;</span><span class="p">:</span> <span class="n">sequencing_group</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">prefix</span><span class="p">()</span> <span class="o">/</span> <span class="n">WORKFLOW_FOLDER</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sequencing_group</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">_cumulative.txt&#39;</span><span class="p">,</span>
</span><span id="__span-2-14">     <span class="p">}</span>
</span><span id="__span-2-15">
</span><span id="__span-2-16"> <span class="k">def</span><span class="w"> </span><span class="nf">queue_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequencing_group</span><span class="p">:</span> <span class="n">SequencingGroup</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">StageInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StageOutput</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-2-17">     <span class="n">input_txt</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">as_path</span><span class="p">(</span><span class="n">sequencing_group</span><span class="p">,</span> <span class="n">GeneratePrimes</span><span class="p">,</span> <span class="s1">&#39;primes&#39;</span><span class="p">)</span>
</span><span id="__span-2-18">     <span class="n">b</span> <span class="o">=</span> <span class="n">get_batch</span><span class="p">()</span>
</span><span id="__span-2-19">
</span><span id="__span-2-20">     <span class="n">cumulative_calc_output_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expected_outputs</span><span class="p">(</span><span class="n">sequencing_group</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
</span><span id="__span-2-21">
</span><span id="__span-2-22">     <span class="c1"># We define a job instance from the `cumulative_calc` job definition.</span>
</span><span id="__span-2-23">     <span class="n">job_cumulative_calc</span> <span class="o">=</span> <span class="n">cumulative_calc</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">sequencing_group</span><span class="p">,</span> <span class="n">input_txt</span><span class="p">,</span> <span class="n">cumulative_calc_output_path</span><span class="p">)</span>
</span><span id="__span-2-24">
</span><span id="__span-2-25">     <span class="n">jobs</span> <span class="o">=</span> <span class="p">[</span><span class="n">job_cumulative_calc</span><span class="p">]</span>
</span><span id="__span-2-26">
</span><span id="__span-2-27">     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_outputs</span><span class="p">(</span>
</span><span id="__span-2-28">         <span class="n">sequencing_group</span><span class="p">,</span>
</span><span id="__span-2-29">         <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">expected_outputs</span><span class="p">(</span><span class="n">sequencing_group</span><span class="p">),</span>
</span><span id="__span-2-30">         <span class="n">jobs</span><span class="o">=</span><span class="n">jobs</span><span class="p">,</span>
</span><span id="__span-2-31">     <span class="p">)</span>
</span><span id="__span-2-32"><span class="c1"># ...</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There is a key consideration to take into account when writing the stages:</p>
<ul>
<li><a href="../considerations-limitations/#no-forward-discovery">No Forward Discovery</a></li>
</ul>
</div>
<h2 id="jobspy-or-equivalent-file-for-job-definitions"><a class="toclink" href="#jobspy-or-equivalent-file-for-job-definitions"><code>jobs.py</code> or equivalent file for <code>Job</code> definitions</a><a class="headerlink" href="#jobspy-or-equivalent-file-for-job-definitions" title="Permanent link">&para;</a></h2>
<p>Every <code>Stage</code> requires a collection of jobs that will be executed within.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is good practice to store these job definitions in their own files, as the definitions can often get long.</p>
</div>
<div class="highlight"><span class="filename">jobs/cumulative_calc.py</span><pre><span></span><code><span id="__span-3-1"><span class="kn">from</span><span class="w"> </span><span class="nn">cpg_flow.targets.sequencing_group</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequencingGroup</span>
</span><span id="__span-3-2"><span class="kn">from</span><span class="w"> </span><span class="nn">hailtop.batch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Batch</span>
</span><span id="__span-3-3"><span class="kn">from</span><span class="w"> </span><span class="nn">hailtop.batch.job</span><span class="w"> </span><span class="kn">import</span> <span class="n">Job</span>
</span><span id="__span-3-4">
</span><span id="__span-3-5">
</span><span id="__span-3-6"><span class="k">def</span><span class="w"> </span><span class="nf">cumulative_calc</span><span class="p">(</span>
</span><span id="__span-3-7">    <span class="n">b</span><span class="p">:</span> <span class="n">Batch</span><span class="p">,</span>
</span><span id="__span-3-8">    <span class="n">sequencing_group</span><span class="p">:</span> <span class="n">SequencingGroup</span><span class="p">,</span>
</span><span id="__span-3-9">    <span class="n">input_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-3-10">    <span class="n">output_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-3-11"><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Job</span><span class="p">]:</span>
</span><span id="__span-3-12">    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Cumulative Calc: </span><span class="si">{</span><span class="n">sequencing_group</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="__span-3-13">    <span class="n">job</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">new_job</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</span><span id="__span-3-14">    <span class="n">primes_path</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">read_input</span><span class="p">(</span><span class="n">input_file_path</span><span class="p">)</span>
</span><span id="__span-3-15">
</span><span id="__span-3-16">    <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-3-17"><span class="s2">    primes=($(cat </span><span class="si">{</span><span class="n">primes_path</span><span class="si">}</span><span class="s2">))</span>
</span><span id="__span-3-18"><span class="s2">    csum=0</span>
</span><span id="__span-3-19"><span class="s2">    cumulative=()</span>
</span><span id="__span-3-20"><span class="s2">    for prime in &quot;$</span><span class="se">{{</span><span class="s2">primes[@]</span><span class="se">}}</span><span class="s2">&quot;; do</span>
</span><span id="__span-3-21"><span class="s2">        ((csum += prime))</span>
</span><span id="__span-3-22"><span class="s2">        cumulative+=(&quot;$csum&quot;)</span>
</span><span id="__span-3-23"><span class="s2">    done</span>
</span><span id="__span-3-24"><span class="s2">    echo &quot;$</span><span class="se">{{</span><span class="s2">cumulative[@]</span><span class="se">}}</span><span class="s2">&quot; &gt; </span><span class="si">{</span><span class="n">job</span><span class="o">.</span><span class="n">cumulative</span><span class="si">}</span>
</span><span id="__span-3-25"><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="__span-3-26">
</span><span id="__span-3-27">    <span class="n">job</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="__span-3-28">
</span><span id="__span-3-29">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----PRINT CUMULATIVE-----&#39;</span><span class="p">)</span>
</span><span id="__span-3-30">    <span class="nb">print</span><span class="p">(</span><span class="n">output_file_path</span><span class="p">)</span>
</span><span id="__span-3-31">    <span class="n">b</span><span class="o">.</span><span class="n">write_output</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">cumulative</span><span class="p">,</span> <span class="n">output_file_path</span><span class="p">)</span>
</span><span id="__span-3-32">
</span><span id="__span-3-33">    <span class="k">return</span> <span class="n">job</span>
</span></code></pre></div>
<p>Once these required components are written, the pipeline is ready to be executed against this framework.</p>
<h2 id="running-the-pipeline"><a class="toclink" href="#running-the-pipeline">Running the pipeline</a><a class="headerlink" href="#running-the-pipeline" title="Permanent link">&para;</a></h2>
<p>All pipelines can only be exclusively run using the <a href="https://pypi.org/project/analysis-runner/"><code>analysis-runner</code> package</a> which grants the user appropriate permissions based on the dataset and access level defined above. <code>analysis-runner</code> requires a repo, commit and the entrypoint file, and then runs the code inside a "driver" image on Hail Batch, logging the invocation to <code>metamist</code> for future audit and reproducibility.</p>
<p>Therefore, the pipeline code needs to be pushed to a remote version control system, for <code>analysis-runner</code> to be able to pull it for execution. A job can then be submitted:</p>
<div class="highlight"><pre><span></span><code><span id="__span-4-1">analysis-runner<span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-2"><span class="w">  </span>--image<span class="w"> </span><span class="s2">&quot;australia-southeast1-docker.pkg.dev/cpg-common/images/cpg_flow:1.0.0&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-3"><span class="w">  </span>--dataset<span class="w"> </span><span class="s2">&quot;fewgenomes&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-4"><span class="w">  </span>--description<span class="w"> </span><span class="s2">&quot;cpg-flow_test&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-5"><span class="w">  </span>--access-level<span class="w"> </span><span class="s2">&quot;test&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-6"><span class="w">  </span>--output-dir<span class="w"> </span><span class="s2">&quot;cpg-flow_test&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-7"><span class="w">  </span>--config<span class="w"> </span><span class="s2">&quot;&lt;YOUR_CONFIG&gt;.toml&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-8"><span class="w">  </span>workflow.py
</span></code></pre></div>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>If the job is successfully created, the analysis-runner output will include a job URL. This driver job will trigger additional jobs, which can be monitored via the <code>/batches</code> page on Hail. Monitoring these jobs helps verify that the workflow ran successfully. When all expected jobs complete without errors, this confirms the successful execution of the workflow and indicates that the <code>cpg_flow</code> package is functioning as intended.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>See the <a href="../docker/#docker">Docker</a> section for instruction on pulling valid images releases.</p>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../installation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation and Build">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Installation and Build
              </div>
            </div>
          </a>
        
        
          
          <a href="../considerations-limitations/" class="md-footer__link md-footer__link--next" aria-label="Next: Considerations and Limitations">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Considerations and Limitations
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.code.copy", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>